<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Coordinates for three way polar plot from 2x3 factor analysis — polar_coords_2x3 • volcano3D</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Coordinates for three way polar plot from 2x3 factor analysis — polar_coords_2x3" />
<meta property="og:description" content="This function creates a 'volc3d' object of S4 class for downstream plots
containing the p-values from a 2x3 factor analysis, expression data
sample data and polar coordinates. For RNA-Seq count data, two functions
deseq_2x3 followed by deseq_2x3_polar() can be used instead." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158679490-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158679490-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">volcano3D</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-book"></span>
     
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Extended_Vignette.html">Volcano3D Vignette</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Additional Tutorials</li>
    <li>
      <a href="../articles/Vignette_2x3.html">volcano3D: 2x3-way analysis</a>
    </li>
    <li>
      <a href="../articles/shiny_builder.html">Using Volcano3D to create Shiny Apps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code"></span>
     
    Reference Manual
  </a>
</li>
<li>
  <a href="https://github.com/KatrionaGoldmann/volcano3D">
    <span class="fab fa-github"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Coordinates for three way polar plot from 2x3 factor analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/KatrionaGoldmann/volcano3D/blob/master/R/polar_coords_2x3.R'><code>R/polar_coords_2x3.R</code></a></small>
    <div class="hidden name"><code>polar_coords_2x3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates a 'volc3d' object of S4 class for downstream plots
containing the p-values from a 2x3 factor analysis, expression data
sample data and polar coordinates. For RNA-Seq count data, two functions
<code><a href='deseq_2x3.html'>deseq_2x3</a></code> followed by <code><a href='deseq_2x3_polar.html'>deseq_2x3_polar()</a></code> can be used instead.</p>
    </div>

    <pre class="usage"><span><span class='fu'>polar_coords_2x3</span><span class='op'>(</span></span>
<span>  <span class='va'>data</span>,</span>
<span>  metadata <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  <span class='va'>outcome</span>,</span>
<span>  <span class='va'>group</span>,</span>
<span>  pvals <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  padj <span class='op'>=</span> <span class='va'>pvals</span>,</span>
<span>  pcutoff <span class='op'>=</span> <span class='fl'>0.05</span>,</span>
<span>  fc_cutoff <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  padj.method <span class='op'>=</span> <span class='st'>"BH"</span>,</span>
<span>  process <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"positive"</span>, <span class='st'>"negative"</span>, <span class='st'>"two.sided"</span><span class='op'>)</span>,</span>
<span>  scheme <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"grey60"</span>, <span class='st'>"red"</span>, <span class='st'>"gold2"</span>, <span class='st'>"green3"</span>, <span class='st'>"cyan"</span>, <span class='st'>"blue"</span>, <span class='st'>"purple"</span>, <span class='st'>"black"</span><span class='op'>)</span>,</span>
<span>  labs <span class='op'>=</span> <span class='cn'>NULL</span>,</span>
<span>  <span class='va'>...</span></span>
<span><span class='op'>)</span></span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Dataframe or matrix with variables in columns and samples in rows</p></td>
    </tr>
    <tr>
      <th>metadata</th>
      <td><p>Dataframe of sample information with samples in rows</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>Either the name of column in <code>metadata</code> containing the binary
outcome data. Or a vector with 2 groups, ideally a factor. If it is not a
factor, this will be coerced to a factor. This must have exactly 2 levels.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>Either the name of column in <code>metadata</code> containing the 3-way
grouping data. Or a vector with 3 groups, ideally a factor. If it is not a
factor, this will be coerced to a factor. This must have exactly 3 levels.
NOTE: if <code>pvals</code> is given, the order of the levels in <code>group</code> must
correspond to the order of columns in <code>pvals</code>.</p></td>
    </tr>
    <tr>
      <th>pvals</th>
      <td><p>Optional matrix or dataframe with p-values in 3 columns. If
<code>pvals</code> is not given, it is calculated using the function
<code><a href='calc_stats_2x3.html'>calc_stats_2x3</a></code>. The p-values in 3 columns represent the
comparison between the binary outcome with each column for the 3 groups as
specified in <code>group</code>.</p></td>
    </tr>
    <tr>
      <th>padj</th>
      <td><p>Matrix or dataframe with adjusted p-values. If not supplied,
defaults to use nominal p-values from <code>pvals</code>.</p></td>
    </tr>
    <tr>
      <th>pcutoff</th>
      <td><p>Cut-off for p-value significance</p></td>
    </tr>
    <tr>
      <th>fc_cutoff</th>
      <td><p>Cut-off for fold change on radial axis</p></td>
    </tr>
    <tr>
      <th>padj.method</th>
      <td><p>Can be <code>"qvalue"</code> or any method available in <code>p.adjust</code>.
The option <code>"none"</code> is a pass-through.</p></td>
    </tr>
    <tr>
      <th>process</th>
      <td><p>Character value specifying colour process for statistical
significant genes: "positive" specifies genes are coloured if fold change
is &gt;0; "negative" for genes with fold change &lt;0 (note that for clarity the
polar position is altered so that genes along each axis have the most
strongly negative fold change values); or "two.sided" which is a compromise
in which positive genes are labelled as before but genes with negative fold
changes and significant p-values have an inverted colour scheme.</p></td>
    </tr>
    <tr>
      <th>scheme</th>
      <td><p>Vector of colours starting with non-significant variables</p></td>
    </tr>
    <tr>
      <th>labs</th>
      <td><p>Optional character vector for labelling groups. Default <code>NULL</code>
leads to abbreviated labels based on levels in <code>outcome</code> using
<code><a href='https://rdrr.io/r/base/abbreviate.html'>abbreviate()</a></code>. A vector of length 3 with custom abbreviated names for the
outcome levels can be supplied. Otherwise a vector length 8 is expected, of
the form "ns", "A+", "A+B+", "B+", "B+C+", "C+", "A+C+", "A+B+C+", where
"ns" means non-significant and A, B, C refer to levels 1, 2, 3 in
<code>outcome</code>, and must be in the correct order.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional arguments passed to <code><a href='calc_stats_2x3.html'>calc_stats_2x3</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an S4 'volc3d' object containing:</p><ul>
<li><p>'df' A list of 2 dataframes. Each dataframe contains both x,y,z
coordinates as well as polar coordinates r, angle. The first dataframe has
coordinates on scaled data. The 2nd dataframe has unscaled data (e.g. log2
fold change for gene expression). The <code>type</code> argument in
<code><a href='volcano3D.html'>volcano3D</a></code>, <code><a href='radial_plotly.html'>radial_plotly</a></code> and
<code><a href='radial_ggplot.html'>radial_ggplot</a></code> corresponds to these dataframes.</p></li>
<li><p>'outcome' The three-group contrast factor used for comparisons,
linked to the <code>group</code> column</p></li>
<li><p>'data' Dataframe or matrix containing the expression data</p></li>
<li><p>'pvals' A dataframe containing p-values in 3 columns representing
the binary comparison for the outcome for each of the 3 groups.</p></li>
<li><p>'padj' A dataframe containing p-values adjusted for multiple testing</p></li>
<li><p>'pcutoff Numeric value for cut-off for p-value significance</p></li>
<li><p>'scheme' Character vector with colour scheme for plotting</p></li>
<li><p>'labs' Character vector with labels for colour groups</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is designed for manually generating a 'volc3d' class object for
visualising a 2x3 way analysis comparing a large number of attributes such as
genes. For RNA-Seq data we suggest using <code><a href='deseq_2x3.html'>deseq_2x3()</a></code> and
<code><a href='deseq_2x3_polar.html'>deseq_2x3_polar()</a></code> functions in sequence instead.</p>
<p>Scaled polar coordinates are generated using the t-score for each group
comparison. Unscaled polar coordinates are generated as difference between
means for each group comparison. If p-values are not supplied they are
calculated by <code><a href='calc_stats_2x3.html'>calc_stats_2x3()</a></code> using either t-tests or wilcoxon tests.</p>
<p>The z axis for 3d volcano plots does not have as clear a corollary in 2x3
analysis as for the standard 3-way analysis (which uses the likelihood ratio
test for the 3 groups). For 2x3 polar analysis the smallest p-value from the
3 group pairwise comparisons for each gene is used to generate a z coordinate
as -log10(p-value).</p>
<p>The colour scheme is not as straightforward as for the standard polar plot
and volcano3D plot since genes (or attributes) can be significantly up or
downregulated in the response comparison for each of the 3 groups.
<code>process = "positive"</code> means that genes are labelled with colours if a gene
is significantly upregulated in the response for that group. This uses the
primary colours (RGB) so that if a gene is upregulated in both red and blue
group it becomes purple etc with secondary colours. If the gene is
upregulated in all 3 groups it is labelled black. Non-significant genes are
in grey.</p>
<p>With <code>process = "negative"</code> genes are coloured when they are significantly
downregulated. With <code>process = "two.sided"</code> the colour scheme means that both
significantly up- and down-regulated genes are coloured with downregulated
genes labelled with inverted colours (i.e. cyan is the inverse of red etc).
However, significant upregulation in a group takes precedence.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='deseq_2x3.html'>deseq_2x3</a></code>, <code><a href='deseq_2x3_polar.html'>deseq_2x3_polar</a></code>,
<code><a href='calc_stats_2x3.html'>calc_stats_2x3</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

<style>
  #left {
    float:left;
  }
  #right {
    width:100%;
    position:relative;
    text-align:right;
    align:right;
    float:right;
  }
  *.icon-grey {color: lightgrey}
  j {
    text-align:center;
    vertical-align:middle;
    position: relative;
    padding-bottom: 12px;
  }
  .smadge:after{
    content:"EMR";
    position: absolute;
    background: lightgrey;
    height:1.2rem;
    top:1rem;
    right:-1rem;
    width:2.3rem;
    text-align: center;
    line-height: 1rem;;
    font-size: 1rem;
    color: #cc0099;
    border-radius: 10%;
  }
  .bladge:after{
    content:"C4TB";
    position: absolute;
    background: lightgrey;
    height:1.2rem;
    top:1rem;
    right:-1rem;
    width:2.7rem;
    text-align: center;
    line-height: 1rem;;
    font-size: 1rem;
    color: #cc0099;
    border-radius: 10%;
  }
</style>

<div id="left">
Developed by <a href="https://www.turing.ac.uk/people/enrichment-students/katriona-goldmann">Katriona Goldmann</a> and <a href="https://www.qmul.ac.uk/whri/people/academic-staff/items/lewismyles.html">Myles Lewis</a>
</div>

<div id="right">
<a href="https://www.qmul.ac.uk/whri/emr/"><j class="fa fa-university fa-2x  icon-grey smadge" aria-hidden="false" style="color:#cc0099"></j></a>
<span style="margin-left:1rem"></span>

<a href="https://www.qmul.ac.uk/c4tb/"><j class="fa fa-university fa-2x  icon-grey bladge" aria-hidden="false" style="color:#cc0099"></j></a>
<span style="margin-left:1rem"></span>

<a href="https://towardsdatascience.com/interactive-differential-expression-analysis-with-volcano3d-cf6c37b5aa6a"><i class="fab fa-medium-m fa-2x" style="color:#cc0099"></i></a>
<span style="margin-left:1rem"></span>
<a href="mailto:k.goldmann@qmul.ac.uk" class="fas fa-envelope fa-2x" style="color:#cc0099">
</a><span style="margin-left:1rem"></span>

<a href="https://github.com/KatrionaGoldmann"><i class="fab fa-github fa-2x" style="color:#cc0099"></i></a>
<span style="margin-left:1rem"></span>

<a href="https://twitter.com/_katriona"><i class="fab fa-twitter fa-2x" style="color:#cc0099"></i></a>
</div>

      </footer>
   </div>

  


  </body>
</html>


